<!-- 수정됨: 대용량 게시판 로딩중 오버레이 + pageSize 설정 + Lazy-loading -->

<!-- ▼▼▼ 여기 추가한다 ▼▼▼ -->
<div
    ng-if="isLoadingPage && pageSize >= 10000"
    style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
    "
>
    <div
        style="
            background: #ffffff;
            padding: 20px 30px;
            border-radius: 4px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.25);
            font-size: 16px;
        "
    >
        10,000개 데이터를 로딩 중입니다. 잠시만 기다려 주세요...
    </div>
</div>
<!-- ▲▲▲ 여기까지 추가 ▲▲▲ -->


<div class="container">
    <div class="action-bar">
        <h1>대용량 게시판</h1>

        <div style="margin-left: auto; display: flex; align-items: center; gap: 10px">
            <div style="color: #666;">
                ※ 총 게시글 수: <strong>{{ totalItems | number }}</strong> 건
            </div>

            <a href="#!/big-posts/new" class="action-btn create-btn">글쓰기</a>
        </div>
    </div>

    <!-- ▼ 총 개수 아래: pageSize 설정 영역 -->
    <div style="margin-top: 10px; display: flex; align-items: center; gap: 20px;">
        <div style="color: #666;">
            총 <strong>{{ totalItems | number }}</strong> 건 중
            한 번에 <strong>{{ pageSize | number }}</strong> 개씩 불러오는 중
        </div>

        <div>
            <label for="pageSizeInput">한 번에 가져올 개수:</label>
            <input
                id="pageSizeInput"
                type="number"
                min="1"
                max="10000"
                ng-model="pageSizeInput"
                style="width: 100px; margin-left: 5px; text-align: right;"
            />
            <button type="button" class="action-btn" ng-click="applyPageSize()" style="margin-left: 5px;">
                적용
            </button>
        </div>
    </div>

    <table class="user-table">
        <thead>
            <tr>
                <th style="width: 10%">번호</th>
                <th style="width: 50%">제목</th>
                <th style="width: 20%">작성자</th>
                <th style="width: 20%">작성일</th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="post in postList | limitTo: visibleCount">
                <td>{{ getRowNumber($index) | number }}</td>
                <td><a href="#!/big-posts/{{ post.post_id }}">{{ post.title }}</a></td>
                <td>{{ post.user_id }}</td>
                <td>{{ post.created_at | date:'yyyy-MM-dd HH:mm' }}</td>
            </tr>

            <tr ng-if="!postList.length">
                <td colspan="4" style="text-align: center; color: #999;">등록된 게시글이 없습니다.</td>
            </tr>
        </tbody>
    </table>

    <div style="margin-top: 15px; text-align: center;">
        <button ng-click="goToPage(currentPage - 1)" ng-disabled="currentPage <= 1" class="action-btn">
            &lt; 이전
        </button>

        <span style="margin: 0 15px; font-weight: bold;">
            Page {{ currentPage }} / {{ totalPages }}
        </span>

        <button ng-click="goToPage(currentPage + 1)" ng-disabled="!canGoNextPage()" class="action-btn">
            다음 &gt;
        </button>
    </div>
</div>

<!-- 수정됨 끝 -->
