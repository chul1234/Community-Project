<!DOCTYPE html>
<html
    lang="ko"
    ng-app="busApp"
>
    <head>
        <meta charset="UTF-8" />
        <title>실습 프로젝트</title>
        <link
            rel="stylesheet"
            href="/css/style.css"
        />

        <script src="/lib/angular.js"></script>
        <script src="/lib/angular-route.js"></script>

        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular-sanitize.js"></script>

        <!-- jQuery (한 번만) -->
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

        <!-- Summernote LITE -->
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote-lite.min.css"
        />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote-lite.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/lang/summernote-ko-KR.min.js"></script>

        <!-- OpenLayers -->
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.4.3/css/ol.css"
            type="text/css"
        />
        <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.4.3/build/ol.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.4.4/proj4.js"></script>
        <script
            type="text/javascript"
            src="https://map.ngii.go.kr/openapi/wmts_ngiiMap_v6.4.3.js?apikey=518BD309EE343709E6FF861BEE6F05D2"
        ></script>

        <!-- Angular App -->
        <script src="/app.js"></script>

        <!-- ✅ 트램 좌표 데이터: busController보다 먼저 -->
        <script src="/tramRouteData.js"></script>

        <!-- 기존 컨트롤러 -->
        <script src="/busController.js"></script>
        <script src="/userController.js"></script>
        <script src="/boardController.js"></script>
        <script src="/bigPostController.js"></script>

        <!-- ===================== -->
        <!-- 통계 차트 추가 (필수) -->
        <!-- ===================== -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="/BoardStatsController.js"></script>
        <script src="/BigBoardStatsController.js"></script>
        <!-- ===================== -->
    </head>

    <body ng-controller="MainController">
        <!-- 전역 로딩 오버레이 -->
        <div
            class="loading-overlay"
            ng-show="isLoading && currentPath.indexOf('/bus') !== 0"
        >
            <div class="loading-box">
                <div class="spinner"></div>
                <p>로딩중입니다...</p>
            </div>
        </div>

        <div class="main-container">
            <header>
                <h1>실습프로젝트</h1>
                <div class="user-info">
                    <span>[{{currentUser.name}}]님</span>
                    <button
                        type="button"
                        ng-click="deleteMyAccount()"
                        class="delete-btn"
                    >
                        회원탈퇴
                    </button>
                    <a href="/logout">
                        <button type="button">로그아웃</button>
                    </a>
                </div>
            </header>

            <nav class="tab-nav">
                <div
                    class="tab-link dropdown"
                    ng-repeat="mainMenu in menuItems"
                    ng-class="{ active: $location.path().startsWith(mainMenu.pathPrefix) }"
                >
                    <a
                        ng-if="mainMenu.subMenus.length > 0"
                        ng-href="{{ mainMenu.subMenus[0].path }}"
                    >
                        {{ mainMenu.menu_name }}
                    </a>

                    <a
                        ng-if="!mainMenu.subMenus.length"
                        ng-href="{{ mainMenu.path }}"
                    >
                        {{ mainMenu.menu_name }}
                    </a>

                    <div class="dropdown-content">
                        <a
                            ng-repeat="subMenu in mainMenu.subMenus"
                            href="{{ subMenu.path }}"
                        >
                            {{ subMenu.menu_name }}
                        </a>
                    </div>
                </div>
            </nav>

            <div class="content-view">
                <div ng-view></div>
            </div>
        </div>
    </body>
</html>
